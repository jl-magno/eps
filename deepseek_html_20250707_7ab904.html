<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Credential Manager</title>
    <style>
        /* CSS Variables for Theming */
        :root {
            --primary-color: #6200ee;
            --primary-light: #9e47ff;
            --primary-dark: #0400ba;
            --secondary-color: #03dac6;
            --secondary-light: #66fff9;
            --secondary-dark: #00a895;
            --background: #ffffff;
            --surface: #ffffff;
            --error: #b00020;
            --on-primary: #ffffff;
            --on-secondary: #000000;
            --on-background: #000000;
            --on-surface: #000000;
            --on-error: #ffffff;
            --text-primary: rgba(0, 0, 0, 0.87);
            --text-secondary: rgba(0, 0, 0, 0.6);
            --text-hint: rgba(0, 0, 0, 0.38);
            --divider: rgba(0, 0, 0, 0.12);
            --shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        /* Dark Theme Variables */
        [data-theme="dark"] {
            --primary-color: #bb86fc;
            --primary-light: #e7b9ff;
            --primary-dark: #8856c9;
            --secondary-color: #03dac6;
            --background: #121212;
            --surface: #1e1e1e;
            --error: #cf6679;
            --on-primary: #000000;
            --on-background: #ffffff;
            --on-surface: #ffffff;
            --text-primary: rgba(255, 255, 255, 0.87);
            --text-secondary: rgba(255, 255, 255, 0.6);
            --text-hint: rgba(255, 255, 255, 0.38);
            --divider: rgba(255, 255, 255, 0.12);
            --shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }

        /* Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            transition: var(--transition);
        }

        body {
            font-family: 'Roboto', Arial, sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        /* Layout */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--divider);
        }

        .app-title {
            font-size: 24px;
            font-weight: 500;
            color: var(--primary-color);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 10px 16px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            border: none;
            outline: none;
            transition: var(--transition);
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: var(--on-primary);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            box-shadow: var(--shadow);
        }

        .btn-secondary {
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background-color: rgba(98, 0, 238, 0.08);
        }

        .btn-icon {
            padding: 8px;
            border-radius: 50%;
            min-width: 36px;
            min-height: 36px;
            background-color: transparent;
            color: var(--text-primary);
        }

        .btn-icon:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] .btn-icon:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Cards */
        .card {
            background-color: var(--surface);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
        }

        /* Forms */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: var(--text-secondary);
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--divider);
            border-radius: 4px;
            background-color: var(--surface);
            color: var(--text-primary);
            font-size: 16px;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        /* Login Screen */
        .login-container {
            max-width: 400px;
            margin: 50px auto;
        }

        .login-card {
            text-align: center;
        }

        .login-icon {
            font-size: 48px;
            margin-bottom: 20px;
            color: var(--primary-color);
        }

        /* Main App */
        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .search-filter {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .search-box {
            flex-grow: 1;
            min-width: 200px;
        }

        .category-filter {
            min-width: 150px;
        }

        /* Credential List */
        .credential-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .credential-item {
            background-color: var(--surface);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 16px;
            position: relative;
        }

        .credential-header {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .credential-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(98, 0, 238, 0.1);
            border-radius: 50%;
            margin-right: 12px;
            color: var(--primary-color);
        }

        .credential-title {
            font-weight: 500;
            font-size: 16px;
            flex-grow: 1;
        }

        .credential-actions {
            display: flex;
            gap: 8px;
        }

        .credential-details {
            margin-top: 12px;
        }

        .credential-row {
            display: flex;
            margin-bottom: 8px;
        }

        .credential-label {
            font-size: 14px;
            color: var(--text-secondary);
            width: 80px;
            flex-shrink: 0;
        }

        .credential-value {
            flex-grow: 1;
            font-size: 14px;
            word-break: break-all;
        }

        .copy-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            padding: 0 4px;
            font-size: 14px;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal {
            background-color: var(--surface);
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            padding: 16px;
            border-bottom: 1px solid var(--divider);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 500;
        }

        .modal-body {
            padding: 16px;
        }

        .modal-footer {
            padding: 16px;
            border-top: 1px solid var(--divider);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Password Field */
        .password-field {
            position: relative;
        }

        .toggle-password {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-hint);
            cursor: pointer;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            color: var(--text-hint);
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }

            .search-filter {
                flex-direction: column;
            }

            .credential-list {
                grid-template-columns: 1fr;
            }
        }

        /* Icons - Using Material Icons as base */
        .material-icons {
            font-family: 'Material Icons';
            font-weight: normal;
            font-style: normal;
            font-size: 24px;
            line-height: 1;
            letter-spacing: normal;
            text-transform: none;
            display: inline-block;
            white-space: nowrap;
            word-wrap: normal;
            direction: ltr;
            -webkit-font-feature-settings: 'liga';
            -webkit-font-smoothing: antialiased;
        }

        /* Dark Mode Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        /* System preference for dark mode */
        @media (prefers-color-scheme: dark) {
            :root {
                --primary-color: #bb86fc;
                --primary-light: #e7b9ff;
                --primary-dark: #8856c9;
                --secondary-color: #03dac6;
                --background: #121212;
                --surface: #1e1e1e;
                --error: #cf6679;
                --on-primary: #000000;
                --on-background: #ffffff;
                --on-surface: #ffffff;
                --text-primary: rgba(255, 255, 255, 0.87);
                --text-secondary: rgba(255, 255, 255, 0.6);
                --text-hint: rgba(255, 255, 255, 0.38);
                --divider: rgba(255, 255, 255, 0.12);
                --shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Login Screen -->
    <div id="login-screen" class="login-container">
        <div class="login-card card">
            <div class="login-icon material-icons">lock</div>
            <h1 class="app-title">Secure Credential Manager</h1>
            <p class="text-center mb-20">Enter master password to continue</p>
            
            <div class="form-group">
                <input type="password" id="master-password" class="form-control" placeholder="Master Password">
                <div id="login-error" class="hidden" style="color: var(--error); margin-top: 8px; font-size: 14px;">
                    Incorrect password. Please try again.
                </div>
            </div>
            
            <button id="login-btn" class="btn btn-primary">Unlock</button>
        </div>
    </div>

    <!-- Main App (Hidden until login) -->
    <div id="app-container" class="container hidden">
        <header>
            <h1 class="app-title">Secure Credential Manager</h1>
            <div class="theme-toggle">
                <span class="material-icons">light_mode</span>
                <label class="switch">
                    <input type="checkbox" id="theme-toggle">
                    <span class="slider"></span>
                </label>
                <span class="material-icons">dark_mode</span>
            </div>
        </header>

        <div class="toolbar">
            <div class="search-filter">
                <div class="search-box">
                    <input type="text" id="search-input" class="form-control" placeholder="Search credentials...">
                </div>
                <div class="category-filter">
                    <select id="category-filter" class="form-control">
                        <option value="">All Categories</option>
                        <option value="Email">Email</option>
                        <option value="Facebook">Facebook</option>
                        <option value="Yandex">Yandex</option>
                        <option value="Website">Website</option>
                    </select>
                </div>
            </div>
            <button id="add-credential-btn" class="btn btn-primary">
                <span class="material-icons">add</span>
                Add Credential
            </button>
        </div>

        <div id="credential-list-container">
            <!-- Credentials will be dynamically inserted here -->
            <div class="empty-state">
                <div class="empty-state-icon material-icons">vpn_key</div>
                <h3>No credentials found</h3>
                <p>Add your first credential by clicking the "Add Credential" button</p>
            </div>
        </div>
    </div>

    <!-- Add/Edit Credential Modal -->
    <div id="credential-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-title">Add New Credential</h3>
                <button id="close-modal" class="btn-icon">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="credential-form">
                    <input type="hidden" id="credential-id">
                    
                    <div class="form-group">
                        <label for="credential-category" class="form-label">Category</label>
                        <select id="credential-category" class="form-control" required>
                            <option value="">Select a category</option>
                            <option value="Email">Email</option>
                            <option value="Facebook">Facebook</option>
                            <option value="Yandex">Yandex</option>
                            <option value="Website">Website</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="website-url-group">
                        <label for="website-url" class="form-label">Website URL</label>
                        <input type="url" id="website-url" class="form-control" placeholder="https://example.com">
                    </div>
                    
                    <div class="form-group" id="standard-fields-group">
                        <label for="credential-username" class="form-label">Username/Email</label>
                        <input type="text" id="credential-username" class="form-control" placeholder="username@example.com">
                        
                        <label for="credential-password" class="form-label">Password</label>
                        <div class="password-field">
                            <input type="password" id="credential-password" class="form-control" placeholder="••••••••">
                            <button type="button" class="toggle-password" data-target="credential-password">
                                <span class="material-icons">visibility</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" id="cancel-credential" class="btn btn-secondary">Cancel</button>
                        <button type="submit" id="save-credential" class="btn btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Main Application
        document.addEventListener('DOMContentLoaded', function() {
            // Constants
            const MASTER_PASSWORD = 'bryson';
            const STORAGE_KEY = 'secureCredentials';
            
            // DOM Elements
            const loginScreen = document.getElementById('login-screen');
            const appContainer = document.getElementById('app-container');
            const masterPasswordInput = document.getElementById('master-password');
            const loginBtn = document.getElementById('login-btn');
            const loginError = document.getElementById('login-error');
            const themeToggle = document.getElementById('theme-toggle');
            const searchInput = document.getElementById('search-input');
            const categoryFilter = document.getElementById('category-filter');
            const addCredentialBtn = document.getElementById('add-credential-btn');
            const credentialListContainer = document.getElementById('credential-list-container');
            const credentialModal = document.getElementById('credential-modal');
            const closeModalBtn = document.getElementById('close-modal');
            const cancelCredentialBtn = document.getElementById('cancel-credential');
            const credentialForm = document.getElementById('credential-form');
            const credentialCategory = document.getElementById('credential-category');
            const websiteUrlGroup = document.getElementById('website-url-group');
            const standardFieldsGroup = document.getElementById('standard-fields-group');
            const modalTitle = document.getElementById('modal-title');
            
            // State
            let credentials = [];
            let isEditing = false;
            let currentEditingId = null;
            
            // Initialize the app
            init();
            
            function init() {
                // Check for saved theme preference or system preference
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme) {
                    document.body.setAttribute('data-theme', savedTheme);
                    themeToggle.checked = savedTheme === 'dark';
                } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.body.setAttribute('data-theme', 'dark');
                    themeToggle.checked = true;
                }
                
                // Load credentials from localStorage
                loadCredentials();
                
                // Event Listeners
                loginBtn.addEventListener('click', handleLogin);
                masterPasswordInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') handleLogin();
                });
                
                themeToggle.addEventListener('change', toggleTheme);
                searchInput.addEventListener('input', filterCredentials);
                categoryFilter.addEventListener('change', filterCredentials);
                addCredentialBtn.addEventListener('click', showAddCredentialModal);
                closeModalBtn.addEventListener('click', hideModal);
                cancelCredentialBtn.addEventListener('click', hideModal);
                credentialForm.addEventListener('submit', handleCredentialSubmit);
                credentialCategory.addEventListener('change', toggleCredentialFields);
                
                // Password visibility toggles
                document.querySelectorAll('.toggle-password').forEach(button => {
                    button.addEventListener('click', function() {
                        const targetId = this.getAttribute('data-target');
                        const input = document.getElementById(targetId);
                        const icon = this.querySelector('.material-icons');
                        
                        if (input.type === 'password') {
                            input.type = 'text';
                            icon.textContent = 'visibility_off';
                        } else {
                            input.type = 'password';
                            icon.textContent = 'visibility';
                        }
                    });
                });
            }
            
            // Authentication
            function handleLogin() {
                const enteredPassword = masterPasswordInput.value.trim();
                
                if (enteredPassword === MASTER_PASSWORD) {
                    loginError.classList.add('hidden');
                    loginScreen.classList.add('hidden');
                    appContainer.classList.remove('hidden');
                    masterPasswordInput.value = '';
                } else {
                    loginError.classList.remove('hidden');
                    masterPasswordInput.focus();
                }
            }
            
            // Theme Management
            function toggleTheme() {
                if (themeToggle.checked) {
                    document.body.setAttribute('data-theme', 'dark');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.body.removeAttribute('data-theme');
                    localStorage.setItem('theme', 'light');
                }
            }
            
            // Credential Management
            function loadCredentials() {
                const savedCredentials = localStorage.getItem(STORAGE_KEY);
                if (savedCredentials) {
                    credentials = JSON.parse(savedCredentials);
                    renderCredentials(credentials);
                }
            }
            
            function saveCredentials() {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(credentials));
                renderCredentials(credentials);
            }
            
            function renderCredentials(credsToRender) {
                if (credsToRender.length === 0) {
                    credentialListContainer.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon material-icons">vpn_key</div>
                            <h3>No credentials found</h3>
                            <p>Add your first credential by clicking the "Add Credential" button</p>
                        </div>
                    `;
                    return;
                }
                
                credentialListContainer.innerHTML = `
                    <div class="credential-list">
                        ${credsToRender.map(cred => createCredentialCard(cred)).join('')}
                    </div>
                `;
                
                // Add event listeners to the action buttons
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = this.getAttribute('data-id');
                        editCredential(id);
                    });
                });
                
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = this.getAttribute('data-id');
                        deleteCredential(id);
                    });
                });
                
                document.querySelectorAll('.copy-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const text = this.getAttribute('data-text');
                        copyToClipboard(text);
                        
                        // Show feedback
                        const originalText = this.innerHTML;
                        this.innerHTML = '<span class="material-icons" style="font-size: 14px;">check</span> Copied!';
                        setTimeout(() => {
                            this.innerHTML = originalText;
                        }, 2000);
                    });
                });
            }
            
            function createCredentialCard(credential) {
                let icon;
                switch(credential.category) {
                    case 'Email':
                        icon = 'email';
                        break;
                    case 'Facebook':
                        icon = 'facebook';
                        break;
                    case 'Yandex':
                        icon = 'public'; // Using generic icon as Yandex doesn't have a Material icon
                        break;
                    case 'Website':
                        icon = 'language';
                        break;
                    default:
                        icon = 'vpn_key';
                }
                
                return `
                    <div class="credential-item">
                        <div class="credential-header">
                            <div class="credential-icon material-icons">${icon}</div>
                            <div class="credential-title">${credential.title || credential.url || credential.username}</div>
                            <div class="credential-actions">
                                <button class="btn-icon edit-btn" data-id="${credential.id}">
                                    <span class="material-icons">edit</span>
                                </button>
                                <button class="btn-icon delete-btn" data-id="${credential.id}">
                                    <span class="material-icons">delete</span>
                                </button>
                            </div>
                        </div>
                        <div class="credential-details">
                            ${credential.category === 'Website' ? `
                                <div class="credential-row">
                                    <div class="credential-label">URL</div>
                                    <div class="credential-value">${credential.url || 'N/A'}</div>
                                </div>
                            ` : `
                                <div class="credential-row">
                                    <div class="credential-label">Username</div>
                                    <div class="credential-value">${credential.username || 'N/A'}</div>
                                    ${credential.username ? `<button class="copy-btn" data-text="${credential.username}">Copy</button>` : ''}
                                </div>
                                <div class="credential-row">
                                    <div class="credential-label">Password</div>
                                    <div class="credential-value">••••••••</div>
                                    <button class="copy-btn" data-text="${credential.password}">Copy</button>
                                </div>
                            `}
                        </div>
                    </div>
                `;
            }
            
            function filterCredentials() {
                const searchTerm = searchInput.value.toLowerCase();
                const selectedCategory = categoryFilter.value;
                
                let filtered = credentials;
                
                if (selectedCategory) {
                    filtered = filtered.filter(cred => cred.category === selectedCategory);
                }
                
                if (searchTerm) {
                    filtered = filtered.filter(cred => {
                        return (
                            (cred.username && cred.username.toLowerCase().includes(searchTerm)) ||
                            (cred.url && cred.url.toLowerCase().includes(searchTerm)) ||
                            (cred.title && cred.title.toLowerCase().includes(searchTerm)) ||
                            cred.category.toLowerCase().includes(searchTerm)
                        );
                    });
                }
                
                renderCredentials(filtered);
            }
            
            // Modal Management
            function showAddCredentialModal() {
                isEditing = false;
                currentEditingId = null;
                modalTitle.textContent = 'Add New Credential';
                credentialForm.reset();
                websiteUrlGroup.classList.add('hidden');
                standardFieldsGroup.classList.add('hidden');
                credentialModal.classList.add('active');
            }
            
            function showEditCredentialModal(credential) {
                isEditing = true;
                currentEditingId = credential.id;
                modalTitle.textContent = 'Edit Credential';
                credentialForm.reset();
                
                document.getElementById('credential-id').value = credential.id;
                document.getElementById('credential-category').value = credential.category;
                
                if (credential.category === 'Website') {
                    document.getElementById('website-url').value = credential.url || '';
                } else {
                    document.getElementById('credential-username').value = credential.username || '';
                    document.getElementById('credential-password').value = credential.password || '';
                }
                
                toggleCredentialFields();
                credentialModal.classList.add('active');
            }
            
            function hideModal() {
                credentialModal.classList.remove('active');
            }
            
            function toggleCredentialFields() {
                const category = credentialCategory.value;
                
                if (category === 'Website') {
                    websiteUrlGroup.classList.remove('hidden');
                    standardFieldsGroup.classList.add('hidden');
                } else if (category) {
                    websiteUrlGroup.classList.add('hidden');
                    standardFieldsGroup.classList.remove('hidden');
                } else {
                    websiteUrlGroup.classList.add('hidden');
                    standardFieldsGroup.classList.add('hidden');
                }
            }
            
            // Credential CRUD Operations
            function addCredential(credential) {
                credential.id = Date.now().toString();
                credentials.push(credential);
                saveCredentials();
            }
            
            function editCredential(id) {
                const credential = credentials.find(c => c.id === id);
                if (credential) {
                    showEditCredentialModal(credential);
                }
            }
            
            function updateCredential(updatedCredential) {
                const index = credentials.findIndex(c => c.id === updatedCredential.id);
                if (index !== -1) {
                    credentials[index] = updatedCredential;
                    saveCredentials();
                }
            }
            
            function deleteCredential(id) {
                if (confirm('Are you sure you want to delete this credential?')) {
                    credentials = credentials.filter(c => c.id !== id);
                    saveCredentials();
                }
            }
            
            function handleCredentialSubmit(e) {
                e.preventDefault();
                
                const category = credentialCategory.value;
                let credentialData;
                
                if (category === 'Website') {
                    const url = document.getElementById('website-url').value.trim();
                    
                    if (!url) {
                        alert('Please enter a valid URL');
                        return;
                    }
                    
                    credentialData = {
                        category,
                        url
                    };
                } else {
                    const username = document.getElementById('credential-username').value.trim();
                    const password = document.getElementById('credential-password').value.trim();
                    
                    if (!username || !password) {
                        alert('Please fill in all fields');
                        return;
                    }
                    
                    credentialData = {
                        category,
                        username,
                        password
                    };
                }
                
                if (isEditing) {
                    credentialData.id = currentEditingId;
                    updateCredential(credentialData);
                } else {
                    addCredential(credentialData);
                }
                
                hideModal();
            }
            
            // Utility Functions
            function copyToClipboard(text) {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
            }
        });
    </script>
</body>
</html>